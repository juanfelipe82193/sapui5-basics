sap.ui.define(["./Command"],function(C){"use strict";var T=function(){};T.createCommand=function(c,o){var r=JSON.stringify(o);return c+("["+r.length+"]")+r;};T.createRequestCommand=function(c,o){return{command:T.createCommand(c,o),method:c};};function P(i,c,t){if(!i||!c||!t){throw"ProgressLogger: invalid args";}this.context=c;this.loader=t;var d=new Set();this.logPerformance=function(n,a){if(!n||!a){return;}d.add(a);var o={name:n,timestamp:Date.now(),token:a};var m={method:C.addClientLog,url:this.loader.getUrl(),authorizationHandler:c.authorizationHandler,token:c.token,command:T.createCommand(C.addClientLog,o)};this.loader.postMessage(m);};this.getTokens=function(){return d;};this.logPerformanceTiming=function(m,p){var e=this;m.sort(function(a,b){return a.timestamp-b.timestamp;});if(!m.length){return;}d.add(c.token);var f=[];while(m.length){f.push(m.splice(0,10));}f.forEach(function(a){var o={records:[],timestamp:Date.now()};a.forEach(function(h){o.records.push({name:h.name,timestamp:h.timestamp,uuid:h.uuid,duration:h.duration,value:h.value,parent_uuid:p});});var b=T.createCommand(C.performanceTiming,o);e.loader.postPerformanceTiming({method:C.performanceTiming,url:e.loader.getUrl(),authorizationHandler:c.authorizationHandler,token:c.token,command:b});});};}T.mark=function(t){window.performance.mark(t);};T.measure=function(n,s,e){var p=window.performance;if(performance.getEntriesByName(s).length!==0){if(!e){p.measure(n,s);}else{p.measure(n,s,e);}}p.clearMarks(s);if(e){p.clearMarks(e);}p.clearMeasures(n);};T.perfObserve=function(c){var _=[];var s;var a=performance.timing.navigationStart;var p=new window.PerformanceObserver(function(l){l.getEntries().forEach(function(e){e.uuid=T.generateToken();e.timestamp=a+e.startTime;if(e.name==="sceneMeasure"){s=e.uuid;}_.push(e);});if(_.find(function(b){return b.name==="sceneCompleted";})){T.measure("sceneMeasure","modelRequested","sceneCompleted");}if(s){_=_.filter(function(b){return b instanceof PerformanceMeasure;});c.progressLogger.logPerformanceTiming(_,s);s="";}});p.observe({entryTypes:["mark","measure"]});};T.createLogger=function(i,c,a){if(!c){return null;}c.progressLogger=new P(i,c,a);T.perfObserve(c);return c.progressLogger;};T.base64ToUint8Array=function(b){var a=atob(b);var l=a.length;var c=new Uint8Array(l);for(var i=0;i<l;i++){c[i]=a.charCodeAt(i);}return c;};T.arrayToColumnMajorMatrixArray16=function(a){if(a.length===16){return[a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]];}if(a.length===12){return[a[0],a[3],a[6],a[9],a[1],a[4],a[7],a[10],a[2],a[5],a[8],a[11],0.0,0.0,0.0,1.0];}if(a.length===3){return[1,0,0,a[0],0,1,0,a[1],0,0,1,a[2],0,0,0,1];}return null;};T.pushElementIntoMapArray=function(m,k,e){var a=m.get(k);if(!a){a=[];m.set(k,a);}else if(a.length>0&&a[a.length-1]===e){return;}a.push(e);};T.generateToken=function(){return g();};function g(){function s(){return Math.floor((1+Math.random())*0x10000).toString(16).substring(1);}return s()+s()+"-"+s()+"-"+s()+"-"+s()+"-"+s()+s()+s();}return T;});
