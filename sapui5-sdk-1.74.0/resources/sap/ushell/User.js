// Copyright (c) 2009-2017 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/thirdparty/URI","sap/ui/base/EventProvider","sap/ui/core/LocaleData"],function(U,E,L){"use strict";function c(o){if(o===undefined){return undefined;}return jQuery.extend(true,{},o);}function g(u){var o;if(u.host&&typeof u.host==="function"&&u.host()){o=u.host();if(typeof u.protocol==="function"&&u.protocol()){o=u.protocol()+"://"+o;}return o;}return"";}function i(t){return t.indexOf("sap_")===0;}var a=function(C){var b=[],B,s,o,S,e=new E();this.getEmail=function(){return C.email;};this.getFirstName=function(){return C.firstName;};this.getFullName=function(){return C.fullName;};this.getId=function(){return C.id;};this.getLanguage=function(){return C.language;};this.getLanguageBcp47=function(){return C.languageBcp47;};this.getLanguageText=function(){var l=sap.ui.getCore().getConfiguration().getLocale(),d=new L(l),f=sap.ui.getCore().getConfiguration().getLanguageTag();f=f.replace("-","_");var h=d.getLanguages(),j=h[f]||this.getLanguage().toUpperCase();return j;};this.getLastName=function(){return C.lastName;};this.getImage=function(){return C.image;};this.setImage=function(u){C.image=u;e.fireEvent("onSetImage",u);};this.attachOnSetImage=function(f,d){e.attachEvent("onSetImage",f,d);};this.isJamActive=function(){return C.isJamActive===true;};this.isLanguagePersonalized=function(){return C.isLanguagePersonalized===true;};this.getTheme=function(t){if(t===a.prototype.constants.themeFormat.ORIGINAL_THEME){return S.originalTheme.theme;}if(t===a.prototype.constants.themeFormat.THEME_NAME_PLUS_URL){return o.theme+(o.locationPath?"@"+o.locationOrigin+o.locationPath:"");}if(t===a.prototype.constants.themeFormat.NWBC){if(i(o.theme)){return o.theme;}return this.getTheme(a.prototype.constants.themeFormat.THEME_NAME_PLUS_URL);}return o.theme;};this.getThemeRoot=function(t){if(C.ranges&&C.ranges.theme&&C.ranges.theme[t]&&C.ranges.theme[t].themeRoot){return C.ranges.theme[t].themeRoot;}return"";};this.setTheme=function(n){if(this.isSetThemePermitted()===false){var d="setTheme not permitted";jQuery.sap.log.error(d);throw new Error(d);}o=this._amendTheme({theme:n,root:this.getThemeRoot(n)},s);if(n!==S.originalTheme.theme){this.setChangedProperties({propertyName:"theme",name:"THEME"},S.originalTheme.theme,n);S=o;}this.applyTheme(n);};this.applyTheme=function(n){var t=this;var T=this._amendTheme({theme:n,root:this.getThemeRoot(n)},s),N;o=T;if(T.suppliedRoot){sap.ui.getCore().applyTheme(T.theme,T.suppliedRoot+"/UI5/");}else if(T.path){sap.ui.getCore().applyTheme(T.theme,T.path+"/UI5/");}else{sap.ui.getCore().applyTheme(T.theme);}sap.ui.require(["sap/ushell/components/applicationIntegration/AppLifeCycle"],function(A){N=t.getTheme(a.prototype.constants.themeFormat.NWBC);A.postMessageToIframeApp("sap.ushell.appRuntime","themeChange",{"currentThemeId":N,"themeServiceRoute":window.location.protocol+"//"+window.location.host+"/comsapuitheming.runtime/themeroot/v1"});});};this.setLanguage=function(n){if(n){this.setChangedProperties({propertyName:"language",name:"LANGUAGE"},C.language,n);C.language=n;}};this.getAccessibilityMode=function(){return C.accessibility;};this.setAccessibilityMode=function(A){if(this.isSetAccessibilityPermitted()===false){var d="setAccessibilityMode not permitted";jQuery.sap.log.error(d);throw new Error(d);}C.accessibility=A;};this.isSetAccessibilityPermitted=function(){return C.setAccessibilityPermitted;};this.isSetThemePermitted=function(){return C.setThemePermitted;};this.getContentDensity=function(){return C.contentDensity;};this.setContentDensity=function(d){if(this.isSetContentDensityPermitted()===false){var f="setContentDensity not permitted";jQuery.sap.log.error(f);throw new Error(f);}this.setChangedProperties({propertyName:"contentDensity",name:"CONTENT_DENSITY"},C.contentDensity,d);C.contentDensity=d;};this.isSetContentDensityPermitted=function(){return C.setContentDensityPermitted;};this.getChangedProperties=function(){return jQuery.extend(true,[],b);};this.setChangedProperties=function(p,d,n){b.push({propertyName:p.propertyName,name:p.name,oldValue:d,newValue:n});};this.resetChangedProperties=function(){b=[];};this.resetChangedProperty=function(p){b=b.filter(function(P){return!(p===P.propertyName);});};this.getTrackUsageAnalytics=function(){return C.trackUsageAnalytics;};this.setTrackUsageAnalytics=function(t){this.setChangedProperties({propertyName:"trackUsageAnalytics",name:"TRACKING_USAGE_ANALYTICS"},C.trackUsageAnalytics,t);C.trackUsageAnalytics=t;};this.setImageConsent=function(d){this.setChangedProperties({propertyName:"isImageConsent",name:"ISIMAGECONSENT"},C.isImageConsent,d);C.isImageConsent=d;};this.getImageConsent=function(){return C.isImageConsent;};s={locationPathUi5:(new U(jQuery.sap.getModulePath(""))).absoluteTo(document.location).pathname(),locationPathCustom:C.themeRoot||"",locationOrigin:g(new U(document.location))};if(!s.locationPathUi5){jQuery.sap.log.warning("User: Could not set UI5 location path");}if(!s.locationPathCustom){jQuery.sap.log.warning("User: Could not set location path for custom themes");}if(!s.locationOrigin){jQuery.sap.log.warning("User: Could not set front-end server location origin");}B=C.bootTheme||{theme:"",root:""};o=this._amendTheme(B,s);S=o;};a.prototype._amendTheme=function(t,s){var T={},b,r;function d(R,s){var u,o,p={};u=new U(R);o=g(u);if(o){p.locationOrigin=o;p.locationPath=u.path();}else{p.locationOrigin=s.locationOrigin;p.locationPath=R;}return p;}if(!t||!t.theme||!s){return{originalTheme:{theme:"",root:""},theme:"",suppliedRoot:"",path:"",locationPath:"",locationOrigin:""};}T.originalTheme=c(t);if(T.originalTheme.theme.indexOf("@")>0){b=T.originalTheme.theme.split("@",2);T.theme=b[0];T.suppliedRoot=b[1];r=d(b[1],s);T.locationPath=r.locationPath;T.path=T.locationPath;T.locationOrigin=r.locationOrigin;return T;}T.theme=T.originalTheme.theme;if(T.originalTheme.root){T.suppliedRoot=T.originalTheme.root;r=d(T.originalTheme.root,s);T.locationPath=r.locationPath;T.path=T.locationPath;T.locationOrigin=r.locationOrigin;return T;}T.suppliedRoot="";if(i(T.theme)){T.locationOrigin=s.locationOrigin;T.locationPath=s.locationPathUi5;T.path="";return T;}T.locationOrigin=s.locationOrigin;T.locationPath=s.locationPathCustom;T.path=T.locationPath;return T;};a.prototype.constants={themeFormat:{ORIGINAL_THEME:"O",THEME_NAME_PLUS_URL:"N+U",NWBC:"NWBC"}};return a;},true);
